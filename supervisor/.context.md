# Supervisor Context: Process Management & Lifecycle

## 1. Role
- **Orchestrator**: `supervisor/supervisor.py` manages the lifecycle of FastAPI (Uvicorn) and Copyparty.
- **Health Monitoring**: Periodically polls the FastAPI `/health` endpoint and restarts failed processes.

## 2. Implementation Guidelines
- **Interpreter Awareness**: MUST use `sys.executable` to launch subprocesses to ensure the entire stack runs on the same runtime (CPython or PyPy).
- **Environment Propagation**: MUST ensure `VIRTUAL_ENV` and other critical environment variables are inherited by child processes.
- **Signals**: Handles `SIGINT` and `SIGTERM` to gracefully shut down all managed processes.

## 3. Reliability
- **Retries**: Automatically restarts subprocesses that exit unexpectedly.
- **Logging**: Unified logging via the root logger, streaming to `logs/server.log`.
