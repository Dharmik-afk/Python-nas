# Backend Context: FastAPI & SQLAlchemy

## 1. Architecture
- **Framework**: FastAPI (Single-port 8000 gateway).
- **ORM**: SQLAlchemy with SQLite (`storage/db/server.db`).
- **Migrations**: Alembic (`alembic/versions`).
- **Pydantic**: Used for request/response schemas and settings validation.

## 2. Implementation Guidelines
- **Routes**: Located in `app/backend/routes/`.
- **CRUD**: Business logic and DB interactions go in `app/backend/database/crud.py`.
- **Services**: External service integrations (like Copyparty) go in `app/backend/services/`.
- **Async**: Prefer `async def` for route handlers. Use `run_in_threadpool` for blocking I/O if necessary.

## 3. Security
- **Middleware**: Auth middleware is enforced at the FastAPI level.
- **Reference**: See role overlay `.context/security.md` for jail confinement rules.
