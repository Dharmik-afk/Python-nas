# Context: app/core/

## Purpose & Responsibility
Contains the essential infrastructure, configuration, and security logic for the application. These modules provide cross-cutting services used by both backend and frontend.

## Key Symbols
- `app/core/auth.py`:
    - `auth_required()`: FastAPI dependency for securing routes (JWT, Session, or Basic Auth).
    - `PurePythonCrypter`: Fallback encryption for environments without the `cryptography` library (e.g., some Termux/PyPy setups).
    - `encrypt_string()`/`decrypt_string()`: Utilities for secure session data storage.
- `app/core/config.py`:
    - `Settings`: Pydantic-based configuration manager.
    - `validate_security()`: Fail-fast startup check for SERVE_DIR jail isolation.
- `app/core/file_security.py`:
    - `validate_and_resolve_path()`: Critical security function for strictly enforcing the directory jail and preventing traversal.
- `app/core/security.py`:
    - `Hasher`: Unified manager for DB password hashing, JWT creation, and Copyparty-compatible hash generation.
- `app/core/session_manager.py`:
    - `Session`: Thread-safe session object with persistence and activity tracking.
    - `SessionManager`: Manages the lifecycle and disk persistence of user sessions.
- `app/core/constants.py`: Centralized definitions for forbidden files and allowed media extensions.
- `app/core/logger.py`: Standardized logging configuration for console and file output.
- `app/core/metrics.py`: Simple persistence-backed manager for tracking server usage stats.
- `app/core/templates.py`: Shared Jinja2 templates instance with authentication context injection.
- `app/core/utils.py`: Networking and system utilities (LAN IP detection, opener script generation).

## Dependencies
- `pydantic`: Configuration validation.
- `passlib`, `jose`: Authentication and security.
- `fastapi`: Template and request handling.
- `aiofiles`: Asynchronous file I/O (where applicable).